\documentclass{labs}

\begin{document}
	\maketitlepage[2]	
	{Чисельно-аналітичне моделювання}
	{Визначення оптимальної стратегії лікування пневмонії на основі результатів клінічних досліджень}
	{Соловйов~C.~О.}
	{		&{Сахаров~С.~Ю.,}\\
			&{Вергун~К.~В.,}\\
			&{Борисенко~П.~Б.,}\\
			&{Федченко~О.~А.,}\\
			&{Дутчак~І.~О.}\\
	}
	{КМ-41м}
	
\tableofcontents
	
\intro
% Сергій: 
% Наповнити:
% 1. Факт існування проблеми неоптимальних стратегій лікування вцілому та пневмонії зокрема.
Під час лікування будь-якої хвороби, безумовно, основною задачею є вилікувати хворого. 
Проте немає єдиного способу вирішити цю задачу, існує деяка множина таких стратегій, покликаних вилікувати пацієнта. 
Усі вони можуть характеризуватись такими числовими показниками, як ціною лікування, часом лікування, безпечністю лікування тощо. 
Тому разом із задачею вилікувати хворого постає побічна задача: вилікувати хворого так, щоб певна характеристика процедури лікування задовольняла деякі наперед задані умови. 

% 2. Посилання на схожу ситуацію із раком.
Наприклад, досить актуальною, безумовно, є задача організації такого стримування пізніх стадій раку, щоб хворий прожив якомога довше \cite{canser-NN}. В цій та подібних задачах до уваги беруться параметри, що характеризують стан хворого, а також параметри, що характеризують терапію.
   
% 3. Породження надії знайти оптимальну стратегію за допомогою математики
Із розвитком інформаційних технологій та із ростом потужностей обчислювальної техніки дана задача видається такою, яку можна вирішити. 
В даній роботі будуть розглянуті існуючі математичні моделі, які вирішують задачі такого класу.
% 4. Навіювання песимістичного настрою у зв'язку із неможливістю отримання необхідної вибірки, бо порушується етичні принципи.
Разом з тим, визначення параметрів цих моделей потребує відповідної вибірки, яка не може бути отримана безпосередньо з цією метою, адже це порушує морально-етичні принципи. 
% 5. Відновлення надії у зв'язку із фактом наявності записів клінічних досліджень. 
Проте, на щастя, така вибірка може бути отримана із записів про протікання хвороби та лікування, зроблених в межах клінічних досліджень.

Дана робота присвячена пошуку найшвидшої стратегії лікування пневмонії, тобто такої стратегії, за якою пацієнт одужує за мінімальну кількість ліжко-днів. 

% Паша: 
% 1. Прочитати, профільтрувати на адекватність


\chapter{Постановка задачі}
% Паша:
% 1. Написати, що ми хочемо та маємо зробити:
 
\chapter{Огляд методів вирішення задач даного класу}
% Сергій: 
% 1. Знайти 3-4 методи (із джерелами) вирішення класу задач
% 2. Описати їх на концептуальному рівні у відповідних секціях розділу
	
	\section{Баєсові мережі}
		
		Баєсова мережа\cite{BayesianNetworks} --- це графічна ймовірнісна модель, що являє собою множину змінних  і ймовірнісних залежностей між ними. 
		В основі цієї моделі лежить теорема Баєса, що визначає співвідношення поточної ймовірності до попередньої.
		
		Баєсова мережа представляється у вигляді орієнтованого ациклічного графа (рис.~\ref{fig:BayesianNetwork}), вершини якого це змінні будь-якого характеру, а ребра задають умовну залежність між змінними.
		\begin{figure}[!htp]%
			\centering
			\includegraphics[scale = 0.6]{PNG/BayesianNetwork.png}%
			\caption{Орієнтований ациклічний граф Баєсової мережі}%
			\label{fig:BayesianNetwork}%
		\end{figure}
		
		Якщо ребро виходить з вершини $A$ у вершину $B$, то $A$ називають предком $B$, а $B$ називають нащадком $A$. 
		Множину вершин-предків вершини $X_{i}$ позначимо $parents(X_{i})$.
		Тоді спільний розподіл значень у вершинах можна розписати як:
		\begin{equation}
		\nonumber
		p(X_{1},\ldots,X_{n}) = \prod_{i=1}^{n}{p(X_{i}|parents(X_{i}))}
		\end{equation}
		
		Конкретні числові значення ймовірностей знаходяться в процесі навчання Баєсової мережі.
		
	\section{Багатофакторна регресія}
	
	Поставлену задачу можна представити у вигляді багатофакторної регресійної моделі\cite{Regression} (нелінійної в загальному випадку):
		
		\begin{equation}
		\nonumber
			y = f(\bold{x}, \bold{w}),
		\end{equation}
		де $y$ --- шукана характеристики;
			$x$ --- вектор незалежних змінних;
			$w$ --- вектор параметрів.
			У нашому випадку, $x$ --- параметри хворого та лікування, $y$ --- кількість ліжко-днів витрачених на лікування.
			
			Параметри $w$ визначаються при мінімізації функції помилки:
			\begin{equation}
				\nonumber
				F(\bold{x}, \bold{w}, \bold{y}) = \sum_{i=1}^{n}{(y_{i} - f_{i}(\bold{x}, \bold{w}))^{2}},
			\end{equation}
			де $n$ --- об'єм вибірки.
			
			А ця задача зводиться до вирішення однорідної системи рівнянь:
			\begin{equation}
				\left\{
				\begin{aligned}
					& \frac{\partial{F}}{\partial{w_{1}}} = 0, \\
					& \ldots \\
					& \frac{\partial{F}}{\partial{w_{m}}} = 0, \\
				\end{aligned}
				\right.
			\end{equation}
			де $m$ --- кількість параметрів.
			
			Проблема використання багатофакторної регресії полягає у необхідності визначення функції $f = f(\bold{x}, \bold{w})$.
			
	\section{Нейронні мережі}
	
	Використання нейронних мереж\cite{NeuralNetwork} для вирішення поставленої задачі дещо схоже на використання багатофакторної регресії
	\begin{equation}
		\nonumber
		y = f(\bold{x}, \bold{W}),
	\end{equation}
	але тут вектор параметрів $W$ має дещо інший характер, а функція $y = f(\bold{x}, \bold{W})$ являє собою суперпозицію функцій активації нейронів, вона визначається в процесі навчання мережі.
	
	В процесі навчання відбувається мінімізація функції помилки
	\begin{equation}
		\nonumber
		F(\bold{x}, \bold{W}, \bold{y}) = \sum_{i=1}^{n}{(y_{i} - f_{i}(\bold{x}, \bold{W}))^{2}}
	\end{equation}
	за рахунок зміни вагів $W$ за алгоритмом зворотного поширення помилки.

\chapter{Пристосування нейронної мережі до вирішення поставленої задачі}

	\section{Архітектура мережі}
		Нейронна мережа приймає на вхід параметри пацієнта та набору препаратів, на виході видає кількість ліжко-днів $N$, необхідних для лікування пацієнта із заданими параметрами при заданому лікуванню (рис.~\ref{fig:NN-concept}).
	
	\begin{figure}[htp!]%
	\includegraphics[scale=1]{PNG/NN-Process.png}%
	\caption{Концептуальна схема процесу роботи нейронної мережі}%
	\label{fig:NN-concept}%
	\end{figure}
	% Паша, Костя: 
	% 1. Структурно-числова інфа про нашу мережу
	
	\section{Вихідні дані}
	% Сергій:
	% 1. Описати наявні дані
	Параметри пацієнта:
	\begin{itemize}
		\item вікова група;
		\item наявність супутніх захворювань;
		\item температура тіла;
		\item характер мокроти;
		\item локалізація НП;
		\item характер поширеності процесу;
		\item характер рентгенодинаміки;
		\item рівень лейкоцитів;
		\item лейкоцитарні зміни;
		\item рівень ШОЕ;
		\item загальний стан;
		\item вірусний агент;
		\item бактеріальний агент.
	\end{itemize}
	
	Параметри пацієнта:
	\begin{itemize}
		\item антибактеріальний препарат №1;
		\item тривалість терапії АБ препарату №1;
		\item антибактеріальний препарат №2;
		\item тривалість терапії АБ препарату №2;
		\item антибактеріальний препарат №3;
		\item тривалість терапії АБ препарату №3;
		\item антибактеріальний препарат №4;
		\item тривалість терапії АБ препарату №4;
		\item противірусний препарат X;
		\item тривалість терапії противірусного препарату X;
		\item тривалість AБ терапії;
		\item продовження лікування.
	\end{itemize}
	%
	% Паша, Костя: 
	% 1. Описати комбінацію даних із мержею (мережами)
	
	\section{Процес навчання}
	% Паша, Костя:
	% 1. Графіки навчань
	% 2. Критерії закінчення навчання
	% 3. Критерії вибору найкращої мережі
	
	\section{Отримані результати}
	% Паша, Костя:
	% 1. Адекватність.
	% 2. Вказати можливі причини таких хороших (поганих) результатів 

\conclusion
% Сергій:
% 1. Вказати, що були розгянуті математичні методи вирішення задачі
В даній практичній роботі було розглянуто математичні моделі, що вирішують задачу пошуку оптимальної стратегії лікування пневмонії на основі результатів клінічних досліджень.

З-поміж розглянутих методів було обрано метод нейронних мереж для вирішення поставленої задачі.
%
% Ігор:
% 1. Прочитати вступ, постановку задачі та отримані результати.
% 2. Прокоментувати результати
% 3. Шляхи покращення
\begin{thebibliography}

\bibitem{canser-NN} 
Polak S. Artificial neural networks based modeling for pharmacoeconomics application / S.~Polak, A.~Skowron, J.~Brandys, A.~Mendyk // Applied Mathematics and Computation. --- 2008. No. 203. --- P. 482--492.
		
\bibitem{BayesianNetworks} 
Jensen~F.~V. Bayesian Networks and Decision Graphs / F.~V.~Jensen // Statistics for engineering and information science. --- Springer. --- New York. --- 2001. --- p. 268

\bibitem{Regression}
Lindley~D.~V. Regression and correlation analysis /D.~V.~Lindley // New Palgrave: A Dictionary of Economics, v. 4, pp. 120–23.

\bibitem{NeuralNetwork}	
Хайкин С. Нейронные сети: полный курс : пер. с англ. / C.~Хайкин. --- 2-е изд. ---  М. : Издательский дом \invcommas{Вильямс}. --- 2006. --- 1104 с.

\end{thebibliography}
	
\append{Вихідні коди} 
% Паша, Костя: 
% 1. Вставити код проги

	\begin{lstlisting}[language=Matlab, basicstyle=\tiny, breaklines=true]
		
	\end{lstlisting}

\end{document}

